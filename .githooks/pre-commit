#!/bin/sh
# Local pre-commit hook to prevent committing a .env file containing secrets.
# Install locally by running: git config core.hooksPath .githooks

php scripts/detect_secrets.php
if [ $? -eq 0 ]; then
  # script prints findings and exits 0 even if findings detected; we rely on output instead
  grepped="$(php scripts/detect_secrets.php | grep -E 'Found:' || true)"
  if [ -n "$grepped" ]; then
    echo "Potential secrets detected in .env. Commit aborted. Please rotate credentials and remove secrets from .env before committing."
    exit 1
  fi
fi

exit 0
